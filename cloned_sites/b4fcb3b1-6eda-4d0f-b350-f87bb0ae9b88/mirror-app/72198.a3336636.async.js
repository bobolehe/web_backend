"use strict";(self.webpackChunkapifox_renderer=self.webpackChunkapifox_renderer||[]).push([["72198"],{529303:function(e,r,l){l.d(r,{h:()=>s});var t=l(838e3);l(641486);let s=e=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:29,height:32,fill:"currentColor",viewBox:"0 0 29 32",...e,children:(0,t.jsx)("path",{fill:"#fff",fillOpacity:.9,d:"M28.333 2A1.667 1.667 0 1 0 25 2v3.82a15 15 0 1 0 2.58 19.35 1.667 1.667 0 0 0-2.795-1.816 11.667 11.667 0 1 1-1.62-14.687h-4.832a1.667 1.667 0 0 0 0 3.333h8.334c.92 0 1.666-.746 1.666-1.667z"})})},591028:function(e,r,l){l.d(r,{default:()=>w});var t=l(838e3),s=l(529303),i=l(169508),n=l(678514),a=l(740565),c=l(966117),o=l(556910),u=l(718180),d=l(929463),h=l(458184),f=l(794397),g=l(641486),p=l(618487),x=l(286616),m=l(347603);let w=()=>{let{setLoginType:e,report:r}=(0,g.useContext)(n.hi),l=(0,x.i)(e=>e.setLastLoginInfo),[s,f]=(0,g.useState)(""),[w,b]=(0,g.useState)(!1),[j,y]=(0,g.useState)(!0),R=(0,g.useRef)();(0,u.A)(()=>{r("page_view")});let{run:O}=(0,p.useRequest)(o.zR,{manual:!0,onSuccess:t=>{b(!1);let{url:s,expires:i,sessionKey:a,heartBeat:u}=null!=t?t:{};if(!s||!i||!a||!u)return void e(n.Gb.Wechat);f(s),y(!1);let d=Math.floor(i/u);R.current=setInterval(async()=>{if((d-=1)<0){clearInterval(R.current),y(!0);return}try{let e=await (0,o.o7)(a);e&&(clearInterval(R.current),r((null==e?void 0:e.newlyRegistered)?"user_register":"user_login",{userId:e.userId}),(0,c.Xh)(e),l({type:n.Gb.WechatOfficialAccount}))}catch(e){clearInterval(R.current),y(!0)}},1e3*u)},onError:r=>{b(!1),"401006"===r.errorCode?d.Ay.error((0,a.hw)({id:"user.request.message.rateLimit"})):"400142"===r.errorCode?e(n.Gb.Wechat):d.Ay.error((0,a.hw)({id:"user.loginOrRegister.qrcode.error"}))}}),k=async()=>{b(!0),O()};return(0,g.useEffect)(()=>(k(),()=>{R.current&&clearInterval(R.current)}),[]),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-content text-center w-full",children:[(0,t.jsx)("h3",{className:"mb-0 text-3xl app-text-fg-high text-center",children:(0,a.hw)({id:"user.loginOrRegister.title"},{appName:i.JB})}),(0,t.jsxs)("p",{className:"m-0",children:[(0,a.hw)({id:"user.loginOrRegister.use"}),"\xa0",(0,t.jsx)("a",{children:(0,a.hw)({id:"user.loginOrRegister.wechat.scan"})}),"\xa0",(0,a.hw)({id:"user.loginOrRegister.login.WechatOfficialAccount"})]}),(0,t.jsx)("div",{className:"flex items-center justify-center mt-2",children:(0,t.jsx)(v,{loading:w,expired:j,url:s,onRefresh:k})}),(0,t.jsxs)("p",{className:"flex items-start flex-wrap mb-6",style:{color:"var(--ui-text-color-secondary)"},children:[(0,a.hw)({id:"user.loginOrRegister.agreement.scan"}),(0,t.jsx)(m.A,{})]}),(0,t.jsx)("div",{className:"w-full pt-4",style:{borderTop:"1px solid var(--ui-border-color-split)"},children:(0,t.jsx)(h.A,{block:!0,size:"large",type:"primary",style:{background:"transparent",color:"var(--ui-primary-base)"},onClick:()=>{r("app_button_click_phone_email"),e(n.Gb.EmailPassword)},children:(0,a.hw)({id:"user.loginOrRegister.login.smsOrEmail"})})})]})};function v(e){let{url:r,loading:l,expired:i,onRefresh:n}=e;return(0,t.jsxs)("div",{className:"rounded-md my-4 p-4 relative overflow-hidden bg-transparent",style:{width:208,height:208,border:"1px solid var(--ui-border-color-split)"},children:[r?(0,t.jsx)("img",{src:r,alt:"qrcode",className:"block w-full h-full rounded-sm"}):null,l||i?(0,t.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center app-bg-fg-high",style:{position:"absolute",top:0,left:0,cursor:"pointer",background:"rgba(0, 0, 0, 0.8)"},onClick:()=>{l||n()},children:[l?(0,t.jsx)(f.A,{spinning:!0,size:"large"}):null,!l&&i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h,{width:32,height:32}),(0,t.jsx)("p",{className:"mt-2 mb-0",style:{color:"#ffffff"},children:(0,a.hw)({id:"user.loginOrRegister.qrcode.expire"})})]}):null]}):null]})}}}]);