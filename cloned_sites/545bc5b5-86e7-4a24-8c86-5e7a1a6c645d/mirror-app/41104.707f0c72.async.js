"use strict";(self.webpackChunkapifox_renderer=self.webpackChunkapifox_renderer||[]).push([["41104"],{438066:function(e,t,a){a.d(t,{Fp:()=>eo,JU:()=>er,vu:()=>eu,aY:()=>es,Ii:()=>ed});var n=a(838e3),i=a(169508),l=a(740565),r=a(577227),o=a(322336),s=a(636758),c=a(919404),d=a(440891),u=a(496411),p=a(483482),m=a(73586),y=a(689368),h=a(190183),g=a(838487),T=a.n(g),b=a(276869),v=a(554692),x=a(458184),A=a(808306),f=a(202130),C=a(671466),j=a(641486),I=a(589328);let M="popover-GOLFrT",S="icon-tjiWVz",N="badge-E8iHhm",E="container-WxXvQA",O="tabs-vNQfpG",R="action-eh5LyV",k="tabNav-ODqazJ",D="tabBadge-T9JitC";var _=a(978052),w=a(794397),$=a(392819),B=a(653814),H=a(963227),q=a(571202);let P="container-nAdObT",U="list-q30D7x",z="item-SBREg9",L="meta-TwVk82",F="avatar-jgEq9k",W="read-PzZZ4Q",V="title-WBKChD",Z="description-_qftUi",K="datetime-gtpdo1",G="extra-UrSBdg",J="notFound-WLNv76";var Q=a(417162),Y=a(398380);function X(e){let{hasMore:t,data:a=[],onActionClick:i,onItemClick:l,onLoadMore:r,emptyText:o}=e,s=(0,j.useRef)(Date.now());return 0===a.length?(0,n.jsx)("div",{className:J,children:(0,n.jsx)(_.A,{description:o})}):(0,n.jsx)("div",{id:`${s.current}`,style:{height:400,overflow:"auto",padding:8},children:(0,n.jsx)(Q.A,{dataLength:a.length,next:r||Y.noop,hasMore:null!=t&&t,loader:(0,n.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,n.jsx)(w.A,{size:"small"})}),endMessage:(0,n.jsx)(n.Fragment,{}),scrollableTarget:`${s.current}`,children:(0,n.jsx)($.Ay,{className:T()(P,U),dataSource:a,renderItem:(e,t)=>{let a,r,o=T()(z,{[W]:e.read}),s=[],c=[];return e.extra&&(e.extra.actions&&(s=e.extra.actions.map((t,a)=>t.confirm?(0,n.jsx)(B.A,{title:t.confirm,onConfirm:()=>i(e.id,t),children:(0,n.jsx)("a",{children:t.label},a)}):(0,n.jsx)("a",{onClick:()=>i(e.id,t),children:t.label},a))),e.extra.tags&&(c=e.extra.tags.map((e,t)=>(0,n.jsx)(H.A,{color:e.color,children:e.label},t))),e.extra.content&&(r=e.extra.content),e.extra.avatar&&(a=(0,n.jsx)(q.A,{className:F,src:e.extra.avatar}))),(0,n.jsxs)($.Ay.Item,{className:o,onClick:()=>null==l?void 0:l(e),actions:s,children:[(0,n.jsx)($.Ay.Item.Meta,{className:L,avatar:a,title:(0,n.jsxs)("div",{className:V,children:[e.title,(0,n.jsx)("div",{className:G,children:c})]}),description:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:Z,children:e.description}),(0,n.jsx)("div",{className:K,children:e.showTime})]})}),(0,n.jsx)("div",{children:r})]},e.key||t)}})})})}let{TabPane:ee}=b.A;function et(e){var t,a,i,l,r,o,s,c,d,u,p,m,y,h,g,_;let{tabTextMap:w,onVisibleChange:$,noticeData:B,onActionClick:H,onItemClick:q,onLoadMore:P,className:U,size:z=16,tooltipTitle:L="",tooltipPlacement:F="bottom",popoverPlacement:W="bottomRight",icon:V="icon-bell1",onReadAll:Z,readAllTooltip:K}=e,[G,J]=(0,j.useState)(!1),[Q,Y]=(0,j.useState)("1"),et=e=>{J(e),$(e)},ea=[{tabKey:1,unreadCount:null!=(p=null==B||null==(a=B[1])||null==(t=a.meta)?void 0:t.unreadCount)?p:0,total:null!=(m=null==B||null==(l=B[1])||null==(i=l.meta)?void 0:i.total)?m:0,list:null!=(y=null==B||null==(r=B[1])?void 0:r.data)?y:[]},{tabKey:3,unreadCount:null!=(h=null==B||null==(s=B[3])||null==(o=s.meta)?void 0:o.unreadCount)?h:0,total:null!=(g=null==B||null==(d=B[3])||null==(c=d.meta)?void 0:c.total)?g:0,list:null!=(_=null==B||null==(u=B[3])?void 0:u.data)?_:[]}].map(e=>({...e,...w[e.tabKey]})),en=ea.reduce((e,t)=>{var a;return e+(null!=(a=t.unreadCount)?a:0)},0),ei=(0,n.jsx)(b.A,{type:"soft-primary-button",className:T()(E,O),onChange:e=>{Y(e)},size:"large",activeKey:Q,tabBarExtraContent:1===Number(Q)?{right:(0,n.jsx)(v.A,{title:(null==K?void 0:K.title)||(0,I.a)({id:"inbox.MarkAllAsRead"}),children:(0,n.jsx)(x.A,{onClick:()=>{null==Z||Z()},type:"text",icon:(0,n.jsx)(C.A,{type:"icon-roller-brush1",size:16})})})}:void 0,children:ea.map(e=>{let{list:t,title:a,unreadCount:i,total:l,tabKey:r,emptyText:o}=e,s=l>t.length;return(0,n.jsx)(ee,{tab:(0,n.jsxs)("span",{className:k,children:[a,i>0&&(0,n.jsx)(A.A,{className:D,count:i})]}),children:(0,n.jsx)(X,{hasMore:s,data:t,onItemClick:e=>{null==q||q(e)},onActionClick:(e,t)=>{null==H||H(e,t),et(!1)},onLoadMore:()=>{null==P||P(r)},emptyText:o})},r)})});return(0,n.jsx)(f.A,{content:ei,className:U,overlayClassName:M,overlayInnerStyle:{padding:0},placement:W,trigger:"click",visible:G,onVisibleChange:et,destroyTooltipOnHide:!0,children:(0,n.jsx)(v.A,{title:L,placement:F,children:(0,n.jsx)(A.A,{count:en,size:"small",title:"",className:T()(R,N,{opened:G}),offset:[-6,4],children:(0,n.jsx)(C.A,{type:V,size:z,className:S})})})})}var ea=a(718180),en=a(929463),ei=a(666804);let el="inBox-bNd3lD";async function er(e){let{id:t,type:a,params:n}=e;switch(a){case"action":(0,r.ZO)(t),"accept"===n.type&&((0,o.OT)(),(0,s.w3)());break;case"item":(0,r.ZO)(t)}}let eo=e=>{let t=e.id,{handleOpenComment:a}=e,{params:n,messages:l,type:o}=e.action;switch(o){case"link":if("planTab"===n.type){(0,ei.Nu)({entityId:n.entityId,entityType:n.entityType});break}if("upgradeModal"===n.type&&(0,ei.Nu)({entityId:n.entityId,entityType:n.entityType,showUpgradeModal:!0}),"mergeRequestReview"===n.type&&(0,d.M)({mergeRequestId:n.mergeRequestId,projectBranchId:n.targetBranchId,projectId:n.projectId}),"COMMENT_CREATED_ON_MAINTAINED_RESOURCE"===n.notificationType||"COMMENT_CREATED_ON_CREATED_RESOURCE"===n.notificationType||"COMMENT_MENTIONED"===n.notificationType||"COMMENT_REPLIED"===n.notificationType||"COMMENT_RESOLVED"===n.notificationType)if(n.projectId!==(0,u.MJ)()){let e=(0,y.DA)(e=>{var t;return null==(t=e.project.projectMap)?void 0:t[n.projectId]});if(!e)return;(0,p.vl)({hashPath:`/project/${n.projectId}/${h.xO[n.entityType]}/${n.entityId}/comment/${n.id}?branchId=${n.projectBranchId}`,data:e})}else null==a||a(null,{...n,entityType:h.xO[n.entityType]});break;default:(0,r.p_)(t,n,async()=>{m.ve.broadcast("TabChannel.BroadcastNoticeActionCallback",{type:"renderer"},{id:t,type:"action",params:{type:n.type}}),i.HZ&&er({id:t,type:"action",params:{type:n.type}})},{successMessage:l&&l.success,isHideFailureMessage:!0,onFailure:e=>{var t;["403036","403055"].includes(null!=(t=null==e?void 0:e.errorCode)?t:"")||en.Ay.error(e.errorMessage)}})}},es=e=>{let{id:t,read:a}=e.item;a||(0,r.Eb)(t).then(()=>{m.ve.broadcast("TabChannel.BroadcastNoticeActionCallback",{type:"renderer"},{id:t,type:"item",params:{}}),i.HZ&&er({id:t,type:"item",params:{}})})};function ec(){return(0,y.Ay)(e=>e.notice.noticeGroupData)}function ed(){let e=ec();return(0,ea.A)(()=>{window.setTimeout(()=>{(0,r.hH)(),(0,r.EG)()},50)}),(0,j.useEffect)(()=>{m.ve.broadcast("TabChannel.TabToolbarStateChange",{type:"tab-renderer"},"TabToolbarState.NoticesChange",e)},[e]),(0,n.jsx)(n.Fragment,{})}let eu=e=>{let{tooltipPlacement:t,popoverPlacement:a,icon:i,size:o}=e,{formatMessage:s}=(0,l.tz)(),d=ec(),u=(0,c.A)();return(0,n.jsx)(et,{className:el,noticeData:d,onVisibleChange:()=>{},tooltipTitle:s({id:"notifications"}),tooltipPlacement:t,popoverPlacement:a,icon:i,size:o,tabTextMap:{3:{title:s({id:"component.globalHeader.event"}),emptyText:s({id:"component.globalHeader.event.empty"})},1:{title:s({id:"component.globalHeader.notification"}),emptyText:s({id:"component.globalHeader.notification.empty"})},2:{title:s({id:"component.globalHeader.message"}),emptyText:s({id:"component.globalHeader.message.empty"})}},onActionClick:(e,t)=>{eo({id:e,action:t,handleOpenComment:u})},onItemClick:e=>{es({item:e})},onReadAll:()=>{(0,r.dc)({type:1})},onLoadMore:e=>{switch(e){case 3:(0,r.f)();break;case 1:(0,r.wO)()}}})}},527246:function(e,t,a){a.d(t,{T:()=>i}),a(765787);var n=a(618487);function i(e,t){"TEAM"===t?n.history.push({pathname:`/main/teams/${e}`,query:{tab:"plan"}}):"ORGANIZATION"===t?n.history.push({pathname:`/main/settings/organizations/${e}/plans`}):console.error("wrong entityType in navigateToPlanPage")}},919404:function(e,t,a){a.d(t,{A:()=>T,H:()=>b});var n=a(775803),i=a(169508),l=a(291341),r=a(660464),o=a(335338),s=a(158534),c=a(496411),d=a(73586),u=a(689368),p=a(190183),m=a(140049),y=a(641486),h=a(135400),g=a(77212);function T(){let{setMenuByPathname:e}=(0,y.useContext)(n.Ay),{openHttpApi:t,openHttpApiCase:a,openDoc:i,openDataSchema:d}=h.Qm.getState(),T=(0,l.M)(e=>e.addActiveMenu),b=(0,l.M)(e=>e.addActiveCommentId),v=(0,g.qc)();return(0,m.A)(async(n,l)=>{let{id:m,entityId:y,entityType:h,projectId:g,projectBranchId:x}=l,A=x||(0,c.sI)();if(!g||!A)return;let f=async n=>{switch(n){case"HTTP_API":null==e||e("/api-manage/"),t({id:y}),T(`apiDetail.${y}`,"COMMENTS"),b(`apiDetail.${y}`,m);break;case"HTTP_API_CASE":null==e||e("/api-manage/"),a({id:y}),T(`apiCase.${y}`,"COMMENTS"),b(`apiCase.${y}`,m);break;case"DOC":null==e||e("/api-manage/"),i({id:y}),T(`doc.${y}`,"COMMENTS"),b(`doc.${y}`,m);break;case"DATA_SCHEMA":null==e||e("/api-manage/"),d({id:y}),T(`apiSchema.${y}`,"COMMENTS"),b(`apiSchema.${y}`,m);break;case"TEST_SCENARIO":null==e||e("/api-test/"),await (0,r.wg)(),await (0,s.S)(),(0,o.DY)({id:y}),T(`testScenario.${y}`,"COMMENTS"),b(`testScenario.${y}`,m)}},C=(0,u.DA)(e=>{var t,a,n;return null!=(n=null==(t=e.projectBranch.map)?void 0:t[A])?n:null==(a=e.apiVersionBranch.map)?void 0:a[A]}),j=p.hU[h];C&&(null==C||!C.isArchived)&&(C.id!==(0,c.U3)()?v(A,{dataId:y,type:p.XV[j],openTab:()=>f(j)}):f(j))})}let b=()=>{let e=T();(0,y.useEffect)(()=>i.xl?(d.gc.on("RendererAction.OpenCommentByPath",e),()=>{d.gc.removeListener("RendererAction.OpenCommentByPath",e)}):()=>null,[e])}},440891:function(e,t,a){a.d(t,{A:()=>h,M:()=>y});var n=a(775803),i=a(545690),l=a(169508),r=a(137361),o=a(2183),s=a(496411),c=a(483482),d=a(73586),u=a(689368),p=a(140049),m=a(641486);let y=e=>{let{mergeRequestId:t,projectBranchId:a,projectId:n}=e;if(t&&a&&n){if(l.xl){var i;d.gc.send("TabChannel.TabToolbarAction","TabToolbarAction.ToMergeRequest",{mergeRequestId:t,projectBranchId:a,project:null!=(i=(0,u.DA)(e=>{var t;return null==(t=e.project.projectMap)?void 0:t[n]}))?i:{id:n}});return}(0,c.dG)(`/project/${n}/branch/${a}/merge-request/${t}`)}};function h(){let{setMenuByPathname:e}=(0,m.useContext)(n.Ay),{openMergeRequestManage:t}=(0,m.useContext)(r.i),a=(0,i.Ay)(),c=(0,p.A)((n,i)=>{let{id:l,projectId:r,projectBranchId:c}=i,d=c||(0,s.sI)();l&&d&&r===(0,s.MJ)()&&(null==e||e("/api-manage/"),d===(0,s.U3)()?t({mergeRequestId:l}):a((0,o.ok)().projectMainBranch,()=>{t({mergeRequestId:l})}))});(0,m.useEffect)(()=>l.xl?(d.gc.on("RendererAction.OpenMergeRequestByPath",c),()=>d.gc.removeListener("RendererAction.OpenMergeRequestByPath",c)):()=>null,[c])}},158534:function(e,t,a){a.d(t,{$:()=>x,S:()=>A});var n=a(432254),i=a(169508),l=a(987016),r=a(353748),o=a(660464),s=a(2183),c=a(496411),d=a(398380),u=a(861418),p=a(325475),m=a(732473),y=a(335338),h=a(964619),g=a(893198),T=a(120773),b=a(382770),v=a(898358);let x=(0,p.vt)((e,t)=>({done:!i.xl,reopen:async t=>{e({done:!1}),(0,l.l1)().setRecording(!1);let a=()=>{e({done:!0}),(0,l.l1)().setRecording(!0)};if(!(0,s.ok)().currentBranchSettings.enableApiTest)return a();let{forkFromBranchId:i,type:p}=(0,s.ok)().projectCurrentBranch;(0,s.IF)()?await (0,n.zD)(i):"VERSION"===p&&(0,n.CZ)(i),await (0,n.iT)(),(0,u.unstable_batchedUpdates)(()=>{for(let e of t.tabList){if(e.startsWith("testScenarioFolder")){let t=(0,d.toSafeInteger)(e.split(".")[1]);(0,h.rw)({id:t,tabState:"resident"});continue}if(e.startsWith("testScenarioInstance")){let t=(0,d.toSafeInteger)(e.split(".")[1]);(0,g.x)({id:t,tabState:"resident"});continue}if(e.startsWith("testReport")){(0,m.cS)({tabState:"resident"});continue}if(e.startsWith("testScenario")){let t=(0,d.toSafeInteger)(e.split(".")[1]),a=(0,c.U3)();(0,s.IF)()&&!(0,o.ZF)().getNode((0,v.EA)("testScenario",t))&&(a=(0,c.sI)()),(0,y.DY)({id:t,tabState:"resident",projectBranchId:a});continue}if(e.startsWith("TEST_SCHEDULED_TASK_ROOT")){(0,T.m)({tabState:"resident"});continue}if(e.startsWith("TEST_SUITE")){let t=(0,d.toSafeInteger)(e.split(".")[1]);(0,b.$I)({id:t,tabState:"resident"});continue}}(0,r.g0)().setActiveKey(t.activeKey),a()})}}));function A(){return new Promise(e=>{x.getState().done&&e();let t=x.subscribe(a=>{let{done:n}=a;n&&(e(),t())})})}}}]);